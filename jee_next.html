<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>JEE Advanced CBT Test</title>

<style>
body{
    font-family: Arial;
    background:#f2f2f2;
    padding:20px;
}
.container{
    background:white;
    max-width:800px;
    margin:auto;
    padding:20px;
    border-radius:10px;
}
select,input{
    width:100%;
    padding:8px;
    margin:8px 0;
}
button{
    padding:8px 15px;
    background:darkblue;
    color:white;
    border:none;
    cursor:pointer;
}
.hidden{display:none;}
.option{
    display:block;
    margin:5px 0;
}
.timer{
    font-size:18px;
    color:red;
    font-weight:bold;
}
</style>
</head>

<body>

<div class="container">

<h2>JEE Advanced Mathematics CBT</h2>

<h3>Create Test</h3>

<input type="text" id="title" placeholder="Test Title">
<input type="password" id="adminPassword" placeholder="Set Password">
<input type="datetime-local" id="testTime">

<label>Topic</label>
<select id="topic">
<option value="calculus">Calculus</option>
<option value="algebra">Algebra</option>
</select>

<label>Difficulty</label>
<select id="difficulty">
<option value="easy">Easy</option>
<option value="medium">Medium</option>
<option value="hard">Hard</option>
</select>

<label>Test Duration (minutes)</label>
<input type="number" id="duration" placeholder="Enter duration">

<button onclick="generateQuestions()">Generate Questions</button>
<button onclick="createTest()">Create Test</button>

<hr>

<h3>Start Test</h3>
<input type="password" id="studentPassword" placeholder="Enter Password">
<button onclick="startTest()">Start Test</button>

<div id="examArea" class="hidden">
<p class="timer" id="timer"></p>
<div id="questionBox"></div>
<button onclick="prevQuestion()">Previous</button>
<button onclick="nextQuestion()">Next</button>
<button onclick="submitTest()">Submit</button>
</div>

<div id="resultBox" class="hidden"></div>

</div>

<script>

let questionBank = {

calculus:{
easy:[
{q:"Derivative of x^2 ?", options:["x","2x","x^2","1"], answer:1},
{q:"∫ x dx ?", options:["x^2/2","x^2","2x","1"], answer:0}
],
medium:[
{q:"Limit sinx/x as x→0 ?", options:["0","1","∞","-1"], answer:1},
{q:"∫ sinx dx ?", options:["cosx","-cosx","sinx","tanx"], answer:1}
],
hard:[
{q:"∫ dx/(x^4+1) is", options:["Elementary","Non-elementary","0","1"], answer:0}
]
},

algebra:{
easy:[
{q:"Roots of x^2-4=0 ?", options:["±1","±2","0","4"], answer:1}
],
medium:[
{q:"Determinant of identity matrix 3x3 ?", options:["0","1","3","9"], answer:1}
],
hard:[
{q:"If abc=1 minimum of a+b+c ?", options:["1","2","3","0"], answer:2}
]
}

};

let testData={}, currentQ=0, score=0, timerInterval;
let userAnswers=[];

/* Generate Questions */
function generateQuestions(){
let topic=document.getElementById("topic").value;
let difficulty=document.getElementById("difficulty").value;
testData.questions=questionBank[topic][difficulty];
alert("Questions Generated!");
}

/* Create Test */
function createTest(){
testData.title=document.getElementById("title").value;
testData.password=document.getElementById("adminPassword").value;
testData.time=document.getElementById("testTime").value;
testData.duration=document.getElementById("duration").value;

if(!testData.questions||!testData.password||!testData.time||!testData.duration){
alert("Fill all fields!");
return;
}
alert("Test Created Successfully!");
}

/* Start Test */
function startTest(){
let pass=document.getElementById("studentPassword").value;

if(pass!==testData.password){
alert("Wrong Password!");
return;
}

let now=new Date();
let testTime=new Date(testData.time);

if(now<testTime){
alert("Test not started yet!");
return;
}

document.getElementById("examArea").classList.remove("hidden");
startTimer();
loadQuestion();
}

/* Timer */
function startTimer(){
let timeLeft=testData.duration*60;
let timer=document.getElementById("timer");

timerInterval=setInterval(()=>{
let minutes=Math.floor(timeLeft/60);
let seconds=timeLeft%60;
timer.innerHTML="Time Left: "+minutes+":"+seconds;

timeLeft--;
if(timeLeft<0){
clearInterval(timerInterval);
submitTest();
}
},1000);
}

/* Load Question */
function loadQuestion(){
let q=testData.questions[currentQ];
let html="<h3>Q"+(currentQ+1)+". "+q.q+"</h3>";

q.options.forEach((opt,i)=>{
html+="<label class='option'><input type='radio' name='option' value='"+i+"'> "+opt+"</label>";
});

document.getElementById("questionBox").innerHTML=html;
}

/* Navigation */
function nextQuestion(){
saveAnswer();
if(currentQ<testData.questions.length-1){
currentQ++;
loadQuestion();
}
}

function prevQuestion(){
saveAnswer();
if(currentQ>0){
currentQ--;
loadQuestion();
}
}

function saveAnswer(){
let selected=document.querySelector('input[name="option"]:checked');
if(selected){
userAnswers[currentQ]=parseInt(selected.value);
}
}

/* Submit */
function submitTest(){
saveAnswer();
clearInterval(timerInterval);

score=0;
testData.questions.forEach((q,i)=>{
if(userAnswers[i]===q.answer){
score++;
}
});

document.getElementById("examArea").classList.add("hidden");
document.getElementById("resultBox").classList.remove("hidden");
document.getElementById("resultBox").innerHTML=
"<h2>Test Finished</h2>"+
"<p>Total Questions: "+testData.questions.length+"</p>"+
"<p>Your Score: "+score+"</p>";
}

</script>

</body>
</html>
